var Shodan=window.Shodan||{};Shodan.UI={};Shodan.UI.Base=Class.create({initialize:function(a){this.el=$(a)}});
Shodan.UI.SlideyPanel=Class.create(Shodan.UI.Base,{initialize:function($super,b,c){this.options=Object.extend({autoHide:true,callback:null,contentSelector:".content",duration:"0.5",openClass:"open",toggleSelector:".hd",transition:"sinusoidal"},c||{});$super(b,this.options);this.build()},animate:function(a,b,c){this.animation=(new S2.FX.Morph(a,{after:function(){this.animating=false;typeof c==="function"&&c()}.bind(this),before:function(){this.animating=true}.bind(this),style:b,duration:this.options.duration,
transition:this.options.transition})).play()},build:function(){var a=this.el.down(this.options.contentSelector);this._hide=this.hideContent.curry(a,function(){this.el.removeClassName(this.options.openClass);typeof this.options.callback==="function"&&this.options.callback()}.bind(this));this._reveal=this.revealContent.curry(a,function(){this.el.addClassName(this.options.openClass);typeof this.options.callback==="function"&&this.options.callback()}.bind(this));this.resetContentCSS(a);this.options.autoHide&&
this._hide();this.el.on("click",this.options.toggleSelector,this.onClick.bind(this))},hideContent:function(a,b){var c=a.measure("margin-box-height");a.store("openHeight",c);this.animate(a,"height: 0",b)},onClick:function(a){a.stop();this.el.hasClassName(this.options.openClass)?this._hide():this._reveal()},resetContentCSS:function(a){a.setStyle({border:"none",margin:0,padding:0,overflow:"hidden"});a.store("openHeight",a.measure("margin-box-height"))},revealContent:function(a,b){var c=a.retrieve("openHeight");
this.animate(a,"height: "+c+"px",b)}});
Shodan.UI.Accordion=Class.create(Shodan.UI.SlideyPanel,{initialize:function($super,b,c){this.options=Object.extend({allowMultiOpen:false,contentSelector:".sub",initialOpenItem:false},c||{});$super(b,this.options)},build:function(){this.el.observe("component:ready",function(){this.el.on("click",this.options.toggleSelector,this.onClick.bind(this))}.bind(this));this.callback=function(){typeof this.options.callback==="function"&&this.options.callback()}.bind(this);this.el.select("ul.root>li>"+this.options.contentSelector).each(function(c){this.resetContentCSS(c);
c.setStyle("height: 0")},this);if(this.options.initialOpenItem){var a,b;a=this.options.initialOpenItem==="first"?this.el.down("li"):this.el.down(this.options.initialOpenItem);b=function(){a.addClassName(this.options.openClass);this.callback();this.el.fire("component:ready")}.bind(this);this.revealContent(a.down(this.options.contentSelector),b)}else this.el.fire("component:ready")},onClick:function(a,b){if(!this.animating){var c=$(b).next(this.options.contentSelector),d=b.up("li"),e;if(d.hasClassName(this.options.openClass))this.hideContent(d.down(this.options.contentSelector),
function(){d.removeClassName(this.options.openClass);this.callback()}.bind(this));else{if((e=this.el.down("."+this.options.openClass))&&!this.options.allowMultiOpen)this.hideContent(e.down(this.options.contentSelector),function(){e.removeClassName(this.options.openClass);this.callback()}.bind(this));this.revealContent(c,function(){c.up("li").addClassName(this.options.openClass);this.callback()}.bind(this))}}}});
Shodan.UI.Slideshow=Class.create(Shodan.UI.Base,{initialize:function($super,b,c){this.options=Object.extend({delay:3,displayTitle:true,height:350,slideSelector:".sh-ui-slideshow-slide",transitionDuration:0.5,width:500},c||{});$super(b,this.options);this.index=0;this.slides=[];this.build();this.play()},build:function(){this.el.setStyle({height:this.options.height+"px",overflow:"hidden",position:"relative",width:this.options.width+"px"});if(this.options.displayTitle){this.slideTitle=(new Element("div")).addClassName("sh-ui-slideshow-title");
this.el.insert(this.slideTitle)}this.el.select(this.options.slideSelector).each(function(a,b){a.writeAttribute("id","sh-ui-slide-"+b);a.setStyle({display:"block",height:"100%",left:0,position:"absolute",top:0,width:"100%"});this.slides.push(a)},this);this.slides[0].setStyle({zIndex:10});this.options.displayTitle&&this.slideTitle.update(this.slides[0].readAttribute("alt"));this.size=this.slides.length},next:function(){this.index===this.size-1?this.transition(0,function(){this.index=0}.bind(this)):
this.transition(this.index+1,function(){this.index++}.bind(this))},pause:function(){this.p.stop()},play:function(){this.p=new PeriodicalExecuter(this.next.bind(this),this.options.delay)},previous:function(){this.index===0?this.transition(this.size-1,function(){this.index=this.size-1}.bind(this)):this.transition(this.index-1,function(){this.index--}.bind(this))},transition:function(a,b){if(a!=this.index){var c=this.slides[this.index],d=this.slides[a];this.slideAnimating&&this.slideFx.cancel();this.options.displayTitle&&
this.updateTitle(this.slides[a].readAttribute("alt"));this.slideFx=(new S2.FX.Morph(d,{after:function(){this.slideAnimating=false;typeof b==="function"&&b()}.bind(this),before:function(){c.setStyle({zIndex:10});d.setStyle({zIndex:20}).setOpacity(0);this.slideAnimating=true}.bind(this),duration:this.options.transitionDuration,engine:"javascript",style:"opacity: 1"})).play()}},updateTitle:function(a){this.slideTitle.morph("opacity: 0",{after:function(){this.slideTitle.morph("opacity: 1",{before:function(){this.slideTitle.setOpacity(0).update(a)}.bind(this),
duration:this.options.transitionDuration/2})}.bind(this),duration:this.options.transitionDuration/2})}});
